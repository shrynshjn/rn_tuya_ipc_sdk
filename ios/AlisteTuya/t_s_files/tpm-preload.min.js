/**
 * TPM 0.0.1
 * Tpm preload js.
 *
 * Copyright 2020-2021 wanglk@tuya.com
 *
 * Released under the MIT License
 *
 * Released on: December 14, 2021
 */
!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";function n(t){var e,r,n,i="";"?"===t.charAt(0)?t=t.substr(1):(e=(r=t.match(/^(http|https|ftp)?(?:[\:\/]*)([a-z0-9\.-]*)(?:\:([0-9]+))?(\/[^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/i),(n=new Object).protocol="",n.host=r[2],n.port="",n.path="",n.query="",n.fragment="",n.href="",r[0]&&(n.href=r[0].split("?")[0]),r[1]&&(n.protocol=r[1]),r[3]&&(n.port=r[3]),r[4]&&(n.path=r[4]),r[5]&&(n.query=r[5]),r[6]&&(n.fragment=r[6]),n)).query&&(t=e.query,i=e.href);for(var o={href:i},p=t.split("&"),c=0;c<p.length;c+=1){var a=p[c].split("=");o[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return o}var t,e,r,i,o,p,c,a,f,u,s,m,d,l="3.3.27",h=[{appid:"tianyan",version:l},{appid:"iot",version:l},{appid:"expo",version:l}];p=function(){for(var t={},e=document.getElementsByTagName("script"),r=0;r<e.length;r++)if(new RegExp("/tpm-preload(-[0-9.]+)?(.min)?.js").test(e[r].src)){t=n(e[r].src);break}return t}(),c=p.appId,a=p.tpmVersion,f=p.href||"",u=h.filter(function(t){return t.appid===c})[0],s=a||u&&u.version||l,m=f.replace(/tpm-preload(-[0-9.]+)?(.min)?.js/g,"tpm-"+s+".min.js")||"https://static1.tuyacn.com/static/ty-lib/tpm3/tpm-"+s+".min.js",d=function(n){var t=Object.keys(n);if(t&&0<t.length){var e=t.filter(function(t){return"href"!==t}).filter(function(t){return"tpmVersion"!==t}).reduce(function(t,e,r){return 0===r?e+"="+n[e]:t+"&"+e+"="+n[e]},"");return function(t){return t+"?"+e}}return function(t){return""+t}}(p)(m),window,t=document,e="script",r=d,i=t.createElement(e),o=t.body,i.async=1,i.src=r,o.insertBefore(i,null)});